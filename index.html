<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Agenda Mensal</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
* { font-family: 'Outfit', system-ui, sans-serif; }
.calendar-day { cursor:pointer; transition:0.2s }
.calendar-day:hover { transform:scale(1.05) }
.selected-day { background:#e0f2fe; outline:3px solid #3b82f6 }
.event-dot { width:8px;height:8px;border-radius:999px;display:inline-block;margin-right:3px }
</style>
</head>

<body class="bg-slate-100 min-h-screen">
<div class="max-w-4xl mx-auto p-4">

<header class="flex items-center justify-between mb-4">
<h1 class="text-2xl font-bold">ðŸ“… Agenda Mensal</h1>
<div class="flex gap-2">
<button onclick="changeMonth(-1)" class="px-3 py-1 bg-white rounded">â—€</button>
<button onclick="goToday()" class="px-3 py-1 bg-blue-500 text-white rounded">Hoje</button>
<button onclick="changeMonth(1)" class="px-3 py-1 bg-white rounded">â–¶</button>
</div>
</header>

<h2 id="monthTitle" class="text-center text-xl font-semibold mb-3"></h2>

<div class="grid grid-cols-7 gap-2 mb-6" id="calendar"></div>

<div id="dayPanel" class="hidden bg-white rounded-xl p-4 mb-6 shadow">
<h3 id="dayTitle" class="font-bold mb-3"></h3>
<div id="dayEvents" class="space-y-3"></div>
</div>

<div class="bg-white rounded-xl p-4 shadow">
<h3 class="font-bold mb-3">âž• Criar evento</h3>

<input id="project" placeholder="Projeto" class="w-full mb-2 p-2 border rounded">
<input type="color" id="color" value="#3b82f6" class="mb-2">

<select id="type" class="w-full mb-2 p-2 border rounded">
<option>Aula</option>
<option>ReuniÃ£o</option>
</select>

<input id="withWho" placeholder="Com quem Ã© a reuniÃ£o (opcional)" class="w-full mb-2 p-2 border rounded">
<input id="link" placeholder="Link do site (opcional)" class="w-full mb-3 p-2 border rounded">

<p class="text-sm text-slate-500 mb-2">
ðŸ“Œ Clique nos dias do calendÃ¡rio para selecionar as datas
</p>

<button onclick="addEvents()" class="w-full bg-blue-500 text-white py-2 rounded">
Criar eventos
</button>
</div>

</div>

<script>
let current = new Date();
let events = JSON.parse(localStorage.getItem("events") || "[]");
let selectedDates = [];

function save(){
  localStorage.setItem("events", JSON.stringify(events));
}

function render(){
  const cal = document.getElementById("calendar");
  cal.innerHTML = "";

  const y = current.getFullYear();
  const m = current.getMonth();

  document.getElementById("monthTitle").textContent =
    current.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});

  ["Dom","Seg","Ter","Qua","Qui","Sex","SÃ¡b"].forEach(d=>{
    cal.innerHTML += `<div class="text-center font-semibold">${d}</div>`;
  });

  const first = new Date(y,m,1).getDay();
  const days = new Date(y,m+1,0).getDate();

  for(let i=0;i<first;i++) cal.innerHTML += "<div></div>";

  for(let d=1; d<=days; d++){
    const date = `${y}-${String(m+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
    const isSelected = selectedDates.includes(date);
    const dayEvents = events.filter(e => e.date === date);

    cal.innerHTML += `
      <div onclick="toggleDate('${date}')"
        class="calendar-day bg-white rounded p-2 text-sm ${isSelected?'selected-day':''}">
        <b>${d}</b><br>
        ${dayEvents.map(e=>`<span class="event-dot" style="background:${e.color}"></span>`).join("")}
      </div>
    `;
  }
}

function toggleDate(date){
  if(selectedDates.includes(date)){
    selectedDates = selectedDates.filter(d => d !== date);
  } else {
    selectedDates.push(date);
  }
  render();
}

function addEvents(){
  if(!project.value.trim()){
    alert("Informe o projeto");
    return;
  }
  if(selectedDates.length === 0){
    alert("Selecione pelo menos um dia no calendÃ¡rio");
    return;
  }

  selectedDates.forEach(date=>{
    events.push({
      project: project.value,
      color: color.value,
      type: type.value,
      withWho: withWho.value,
      link: link.value,
      date
    });
  });

  selectedDates = [];
  project.value = "";
  withWho.value = "";
  link.value = "";

  save();
  render();
}

function changeMonth(n){
  current.setMonth(current.getMonth() + n);
  selectedDates = [];
  render();
}

function goToday(){
  current = new Date();
  selectedDates = [];
  render();
}

render();
</script>
</body>
</html>
